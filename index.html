<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>BIST PortfÃ¶y Takip - HaftalÄ±k SimÃ¼lasyon</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body { font-family: Arial; background:#0f172a; color:white; margin:0; padding:15px;}
  h1 { text-align:center; }
  .card { background:#1e293b; padding:15px; border-radius:10px; margin-bottom:15px; overflow-x:auto; }
  table { width:100%; border-collapse: collapse; min-width:700px; }
  th, td { padding:8px; text-align:center; border-bottom:1px solid #334155; white-space: nowrap; }
  th { background:#334155; }
  tr:nth-child(even){background:#1e293b;}
  .positive { color:#22c55e; }
  .negative { color:#ef4444; }
  .big { font-size:22px; font-weight:bold; }
  .timebox { text-align:right; font-size:13px; opacity:0.8; }
  button { padding:10px; width:100%; background:#2563eb; color:white; border:none; border-radius:8px; margin-top:10px; cursor:pointer;}
  button:hover { background:#1d4ed8; }
  .weekly-table { overflow-x:auto; margin-top:10px; }
</style>
</head>
<body>

<h1>ðŸ“Š PortfÃ¶y Takip - HaftalÄ±k SimÃ¼lasyon</h1>

<div class="card">
  <div class="big" id="totalValue">Toplam DeÄŸer: YÃ¼kleniyor...</div>
  <div class="big" id="totalProfit">Toplam Kar: -</div>
  <div class="timebox" id="liveClock"></div>
  <div class="timebox" id="lastUpdate"></div>
</div>

<div class="card">
<table>
<thead>
<tr>
  <th>Hisse</th>
  <th>Lot</th>
  <th>Maliyet(TL)</th>
  <th>GÃ¼ncel Hisse DeÄŸeri(TL)</th>
  <th>AnlÄ±k Fiyat(TL)</th>
  <th>K/Z(TL)</th>
  <th>K/Z(%)</th>
</tr>
</thead>
<tbody id="portfolioBody"></tbody>
</table>
</div>

<div class="card">
<button onclick="saveWeekly()">HaftayÄ± Kaydet (SimÃ¼lasyon)</button>
<div class="weekly-table">
<table id="weeklyTable">
  <thead id="weeklyHead"></thead>
  <tbody id="weeklyBody"></tbody>
</table>
</div>
</div>

<script>
// PortfÃ¶y tanÄ±mÄ±
const portfolio = [
  { code:"THYAO", lot:50, cost:11930.00 },
  { code:"TUPRS", lot:70, cost:8649.90 },
  { code:"ASELS", lot:50, cost:3180.50 }
];

// TÃ¼rkÃ§e sayÄ± formatÄ±
function formatNumber(num) {
  return num.toLocaleString("tr-TR",{ minimumFractionDigits:2, maximumFractionDigits:2 });
}

// AnlÄ±k saat
function updateClock() {
  const now = new Date();
  document.getElementById("liveClock").innerText = "AnlÄ±k Saat: " + now.toLocaleTimeString();
}

// ---------------------
// SimÃ¼lasyon: HaftalÄ±k veriler
// 09.02.2026 â€“ 13.02.2026
const mockWeeklyData = {
  "2026-02-09": { "THYAO":15000.50, "TUPRS":12000.75, "ASELS":8200.00 },
  "2026-02-10": { "THYAO":15250.00, "TUPRS":11900.25, "ASELS":8300.50 },
  "2026-02-11": { "THYAO":15100.75, "TUPRS":12150.00, "ASELS":8400.00 },
  "2026-02-12": { "THYAO":15300.00, "TUPRS":12200.00, "ASELS":8350.25 },
  "2026-02-13": { "THYAO":15500.50, "TUPRS":12350.75, "ASELS":8450.00 }
};

// ---------------------
// PortfÃ¶y tablosunu simÃ¼lasyon ile doldurma
function updatePortfolio() {
  const tbody = document.getElementById("portfolioBody");
  tbody.innerHTML = "";
  let totalValue = 0;
  let totalCost = 0;

  for (let stock of portfolio) {
    const lastDate = "2026-02-13"; // son gÃ¼n deÄŸerini alÄ±yoruz
    const price = mockWeeklyData[lastDate][stock.code] / stock.lot;
    const value = price * stock.lot;
    const profitTL = value - stock.cost;
    const profitPercent = (profitTL / stock.cost) * 100;

    totalValue += value;
    totalCost += stock.cost;

    tbody.innerHTML += `
      <tr>
        <td>${stock.code}</td>
        <td>${stock.lot}</td>
        <td>${formatNumber(stock.cost)}</td>
        <td>${formatNumber(value)}</td>
        <td>${formatNumber(price)}</td>
        <td class="${profitTL>=0?'positive':'negative'}">${formatNumber(profitTL)}</td>
        <td class="${profitPercent>=0?'positive':'negative'}">${profitPercent.toFixed(2)}%</td>
      </tr>`;
  }

  const totalProfitTL = totalValue - totalCost;
  const totalProfitPercent = (totalProfitTL / totalCost)*100;
  document.getElementById("totalValue").innerText = "Toplam DeÄŸer: " + formatNumber(totalValue);
  document.getElementById("totalProfit").innerHTML = 
    "Toplam Kar: <span class='"+(totalProfitTL>=0?'positive':'negative')+"'>"+formatNumber(totalProfitTL)+" ("+totalProfitPercent.toFixed(2)+"%)</span>";

  document.getElementById("lastUpdate").innerText = "Son Yenilenme: " + new Date().toLocaleTimeString();
}

// ---------------------
// HaftalÄ±k tablo render fonksiyonu
function renderWeeklyTable() {
  const weeklyHead = document.getElementById("weeklyHead");
  const weeklyBody = document.getElementById("weeklyBody");

  const dates = Object.keys(mockWeeklyData).sort((a,b)=>new Date(a)-new Date(b));

  // Header
  let headerRow = "<tr><th>Hisse</th>";
  for (let date of dates) {
    headerRow += `<th>${new Date(date).toLocaleDateString("tr-TR")}</th>`;
  }
  headerRow += "</tr>";
  weeklyHead.innerHTML = headerRow;

  // Body
  let rows = "";
  for (let stock of portfolio) {
    rows += `<tr><td>${stock.code}</td>`;
    for (let i=0;i<dates.length;i++){
      const date = dates[i];
      const value = mockWeeklyData[date][stock.code];
      let className = "";
      if(i>0){
        const prevValue = mockWeeklyData[dates[i-1]][stock.code];
        if(value > prevValue) className="positive";
        else if(value < prevValue) className="negative";
      }
      rows += `<td class="${className}">${formatNumber(value)}</td>`;
    }
    rows += "</tr>";
  }
  weeklyBody.innerHTML = rows;
}

// ---------------------
// SimÃ¼lasyon iÃ§in "HaftayÄ± Kaydet" butonu (mock)
function saveWeekly() {
  alert("SimÃ¼lasyon: HaftalÄ±k veriler zaten yÃ¼klendi.");
}

// ---------------------
// BaÅŸlangÄ±Ã§
updateClock();
setInterval(updateClock,1000);
updatePortfolio();
renderWeeklyTable();
</script>

</body>
</html>
