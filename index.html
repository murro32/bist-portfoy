<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>BIST PortfÃ¶y Takip</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
body { font-family: Arial; background:#0f172a; color:white; margin:0; padding:15px;}
h1 { text-align:center; margin-bottom:20px; }

.card {
  background: linear-gradient(145deg, #1e293b, #0f172a);
  padding:15px;
  border-radius:10px;
  margin-bottom:20px;
  overflow-x:auto;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}

table {
  width:100%;
  border-collapse: collapse;
  min-width:700px;
  table-layout: fixed;
}

th, td {
  padding:10px;
  text-align:center;
  border-bottom:1px solid #334155;
  font-size:13px;
  white-space:nowrap;
}

thead th { position: sticky; top:0; background:#334155; z-index:1; }

tr:nth-child(even){ background:#1e293b; }
tr:hover { background:#334155; transition:0.2s; }

.positive { color:#22c55e; font-weight:bold; }
.negative { color:#ef4444; font-weight:bold; }
.neutral { color:white; }

.big { font-size:22px; font-weight:bold; }

.timebox { text-align:right; font-size:12px; opacity:0.8; margin-top:5px; }

td span {
  font-size:10px;
  color:#94a3b8;
  display:inline;
  margin-left:4px;
}

.daily-positive { color:#22c55e; font-weight:bold; }
.daily-negative { color:#ef4444; font-weight:bold; }
.daily-neutral { color:white; }

@media screen and (max-width:768px){
  table { min-width:600px; }
  th, td { padding:8px; font-size:12px; }
}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h1>ðŸ“Š PortfÃ¶y Takip</h1>

<div class="card">
  <div class="big" id="totalValue">Toplam DeÄŸer: YÃ¼kleniyor...</div>
  <div class="big" id="totalProfit">Toplam Kar: -</div>
  <div class="timebox" id="liveClock"></div>
  <div class="timebox" id="lastUpdate"></div>
</div>

<div class="card">
<table>
<thead>
<tr>
  <th>Hisse</th>
  <th>Lot</th>
  <th>Maliyet(TL)</th>
  <th>GÃ¼ncel Hisse DeÄŸeri(TL)</th>
  <th>AnlÄ±k Fiyat(TL)</th>
  <th>K/Z(TL)</th>
  <th>K/Z(%)</th>
</tr>
</thead>
<tbody id="portfolioBody"></tbody>
</table>
</div>

<div class="card">
  <h3>GÃ¼nlÃ¼k KapanÄ±ÅŸ Logu</h3>
  <table>
    <thead>
      <tr>
        <th>Tarih</th>
        <th>Toplam DeÄŸer</th>
        <th>Toplam Kar/Zarar</th>
      </tr>
    </thead>
    <tbody id="dailyLogTable"></tbody>
  </table>
</div>

<div class="card">
  <h3>PortfÃ¶y DeÄŸeri GrafiÄŸi</h3>
  <canvas id="portfolioChart" height="150"></canvas>
</div>

<div class="card">
  <h3>AnlÄ±k Hisse DeÄŸerleri</h3>
  <canvas id="stockChart" height="150"></canvas>
</div>

<script>
// ---------------------
// PORTFÃ–Y VERÄ°LERÄ° (sabit deÄŸerler)
// ---------------------
const portfolio = [
  { code:"THYAO", lot:50, cost:11930.00, price:328.25, prevClose:320.00 },
  { code:"TUPRS", lot:70, cost:8649.90, price:222.10, prevClose:225.00 },
  { code:"ASELS", lot:50, cost:3180.50, price:310.25, prevClose:312.00 },
  { code:"ENERY", lot:2544.83, cost:5547.72, price:2.55, prevClose:2.50 },
  { code:"ALARK", lot:50, cost:6178.50, price:110.30, prevClose:112.00 },
  { code:"MIATK", lot:100, cost:4564.00, price:40.14, prevClose:41.00 },
  { code:"PETKM", lot:200, cost:3664.00, price:18.50, prevClose:18.46 }
];

// ---------------------
// FORMAT
// ---------------------
function formatNumber(num) {
  return num.toLocaleString("tr-TR",{ minimumFractionDigits:2, maximumFractionDigits:2 });
}

// ---------------------
// SAAT
// ---------------------
function updateClock() {
  const now = new Date();
  document.getElementById("liveClock").innerText =
    "AnlÄ±k Saat: " + now.toLocaleTimeString("tr-TR");
}

// ---------------------
// PORTFÃ–Y GÃœNCELLE
// ---------------------
function updatePortfolio() {
  const tbody = document.getElementById("portfolioBody");
  tbody.innerHTML = "";

  let totalValue = 0;
  let totalCost = 0;

  portfolio.forEach(stock => {
    const value = stock.price * stock.lot;
    const profitTL = value - stock.cost;
    const profitPercent = (profitTL / stock.cost)*100;
    const priceDiffPercent = ((stock.price - stock.prevClose)/stock.prevClose)*100;

    totalValue += value;
    totalCost += stock.cost;

    const priceColor =
      priceDiffPercent > 0 ? "positive" :
      priceDiffPercent < 0 ? "negative" : "neutral";

    const profitColor = profitTL >= 0 ? "positive":"negative";

    tbody.innerHTML += `
      <tr>
        <td>${stock.code}</td>
        <td>${formatNumber(stock.lot)}</td>
        <td>${formatNumber(stock.cost)}</td>
        <td>${formatNumber(value)}</td>
        <td class="${priceColor}">
          ${formatNumber(stock.price)}
          <span>(${formatNumber(stock.prevClose)} ${priceDiffPercent>=0?'+':''}${priceDiffPercent.toFixed(2)}%)</span>
        </td>
        <td class="${profitColor}">${formatNumber(profitTL)}</td>
        <td class="${profitColor}">${profitPercent.toFixed(2)}%</td>
      </tr>
    `;
  });

  const totalProfit = totalValue - totalCost;
  const totalPercent = (totalProfit/totalCost)*100;

  document.getElementById("totalValue").innerText =
    "Toplam DeÄŸer: " + formatNumber(totalValue);

  document.getElementById("totalProfit").innerHTML =
    "Toplam Kar: <span class='" +
    (totalProfit>=0?"positive":"negative")+"'>"+
    formatNumber(totalProfit)+" ("+totalPercent.toFixed(2)+"%)</span>";

  document.getElementById("lastUpdate").innerText =
    "Son Yenilenme: " + new Date().toLocaleTimeString("tr-TR");

  showDailyLog();
  updatePortfolioChart();
  updateStockChart();
}

// ---------------------
// GÃœNLÃœK LOGU (simÃ¼lasyon)
// ---------------------
function showDailyLog() {
  const log = [
    { date:"18.02.2026", totalValue:"100.000,00", totalProfit:"+2.000,00" },
    { date:"19.02.2026", totalValue:"102.500,00", totalProfit:"+2.500,00" },
    { date:"20.02.2026", totalValue:"101.000,00", totalProfit:"-1.500,00" }
  ];

  const tbody = document.getElementById("dailyLogTable");
  tbody.innerHTML = "";

  log.forEach(item => {
    const profitClass =
      item.totalProfit.includes('-') ? "daily-negative" :
      item.totalProfit === "0,00" ? "daily-neutral" :
      "daily-positive";

    tbody.innerHTML += `<tr>
      <td>${item.date}</td>
      <td>${item.totalValue}</td>
      <td class="${profitClass}">${item.totalProfit}</td>
    </tr>`;
  });
}

// ---------------------
// PORTFÃ–Y CHART
// ---------------------
function updatePortfolioChart() {
  const log = [
    { date:"18.02.2026", totalValue:100000 },
    { date:"19.02.2026", totalValue:102500 },
    { date:"20.02.2026", totalValue:101000 }
  ];
  const labels = log.map(i => i.date);
  const values = log.map(i => i.totalValue);

  const ctx = document.getElementById("portfolioChart").getContext('2d');
  new Chart(ctx, {
    type:'line',
    data:{
      labels:labels,
      datasets:[{
        label:'Toplam DeÄŸer',
        data:values,
        fill:true,
        borderColor:'#22c55e',
        backgroundColor:'rgba(34,197,94,0.2)',
        tension:0.3
      }]
    },
    options:{responsive:true}
  });
}

// ---------------------
// HÄ°SSE CHART
// ---------------------
function updateStockChart() {
  const labels = portfolio.map(s => s.code);
  const data = portfolio.map(s => s.price);
  const backgroundColors = portfolio.map(s =>
    s.price - s.prevClose > 0 ? '#22c55e' :
    s.price - s.prevClose < 0 ? '#ef4444' : '#ffffff'
  );

  const ctx = document.getElementById("stockChart").getContext('2d');
  new Chart(ctx,{
    type:'bar',
    data:{labels:labels, datasets:[{ label:'AnlÄ±k Fiyat', data:data, backgroundColor:backgroundColors }]},
    options:{responsive:true}
  });
}

// ---------------------
// BAÅžLAT
// ---------------------
updateClock();
setInterval(updateClock,1000);
updatePortfolio();
setInterval(updatePortfolio,60000);

</script>
</body>
</html>
